<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="chrome=1" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1, maximum-scale=1"
		/>
		<link
			href="https://fonts.googleapis.com/css?family=Architects+Daughter"
			rel="stylesheet"
			type="text/css"
		/>
		<link
			rel="stylesheet"
			type="text/css"
			href="stylesheets/stylesheet.css"
			media="screen"
		/>
		<link
			rel="stylesheet"
			type="text/css"
			href="stylesheets/pygment_trac.css"
			media="screen"
		/>
		<link
			rel="stylesheet"
			type="text/css"
			href="stylesheets/print.css"
			media="print"
		/>
		<!--[if lt IE 9]>
			<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		<title>SAPUI5-Deployer by Yelcho</title>
	</head>

	<body>
		<header>
			<div class="inner">
				<h1>SAPUI5-Deployer</h1>
				<h2>ABAP deployment of SAPUI5 apps from Github</h2>
				<h2>Version 2</h2>
				<a href="https://github.com/Yelcho/sapui5-deployer" class="button"
					><small>View project on</small> GitHub</a
				>
			</div>
		</header>
		<div id="content-wrapper">
			<div class="inner clearfix">
				<section id="main-content">
					<h1>
						<a
							id="introduction"
							class="anchor"
							href="#introduction"
							aria-hidden="true"
							><span class="octicon octicon-link"></span></a
						>Welcome to SAPUI5-Deployer
					</h1>
					<p>
						SAPUI5-Deployer is a solution for deploying SAPUI5 and OpenUI5 web
						apps to a SAP ABAP Web Application Server automatically. It is
						designed to simplify the developer workflow by automating the
						following steps.
					</p>
					<ul>
						<li>Download of Github Archive</li>
						<li>Remove wrapper subdirectory from archive</li>
						<li>Minify CSS & Javascript files</li>
						<li>Build Component-preload.js file where required</li>
						<li>
							Recursively perform above steps for any required Github submodules
						</li>
						<li>Package up all artifacts into a deployment archive</li>
						<li>Optionally save deployment archive to file system</li>
						<li>Deploy to SAP Internet Communications Framework</li>
						<li>Invalidate the UI5 cache buster</li>
					</ul>
					<table style="border: 0px">
						<tr>
							<td style="border: 0px">
								<img src="images/SAPUI5logo.png" width="100%" />
							</td>
							<td style="border: 0px">
								<img src="images/OpenUI5_newlogo.png" width="60%" />
							</td>
						</tr>
					</table>
					<br />
					<p>
						SAPUI5-Deployer is designed to be part of a Continuous Deployment
						solution so that your SAPUI5 apps are automatically deployed to your
						ABAP development system when changes are committed.
					</p>
					<p>
						Whilst CI/CD solutions can be built with more traditional tools I
						often find SAP customers and their support teams unfamiliar with
						these concepts. This is results in a reluctance to implement the
						required infrastructure for a traditional CI/CD solution.
					</p>
					<p>
						SAPUI5-Deployer can be implemented by the an ABAP developer in
						minutes, in most cases without the need for any infrastructure
						changes, whilst conforming to existing change management policies
						and procedures.
					</p>
					<p>
						See the end of this page for more discussions on how SAPUI5-Deployer
						can be implemented as part of a CI/CD solution.
					</p>
					<h1>
						<a
							id="system-requirements"
							class="anchor"
							href="#system-requirements"
							aria-hidden="true"
							><span class="octicon octicon-link"></span></a
						>System Requirements
					</h1>
					<p>
						This solution was originally built on a SAP WAS ABAP 7.31 SP5 system
						with the SAP_UI software component also installed. There is no
						reason it should not work on all releases that have the SAP provided
						function module <code>/ui5/ui5_repository_load_http</code>.
					</p>
					<p>
						Most recently the code was refactored on a SAP WAS ABAP 7.50 SP2
						system so you may need to refactor some of the code if you are on an
						earlier release.
					</p>
					<p>
						Installation requires the
						<a href="http://abapgit.org">abapGit</a> project by
						<a href="https://github.com/larshp" target="_blank">@larshp</a>.
					</p>
					<p><img src="images/abapgit.png" /></p>
					<p>
						Instructions for installing abapGit can be found
						<a href="https://docs.abapgit.org/" target="_blank">here</a>.
					</p>
					<p>
						If you haven't seen abapGit before I highly recommend you take a
						good look at it. If you find it useful perhaps you could consider
						joining the project and making your own contributions?
					</p>
					<h1>
						<a
							id="installation"
							class="anchor"
							href="#installation"
							aria-hidden="true"
							><span class="octicon octicon-link"></span></a
						>Installation
					</h1>
					<h2>
						<a
							id="installation1"
							class="anchor"
							href="#installation1"
							aria-hidden="true"
							><span class="octicon octicon-link"></span></a
						>SSL setup
					</h2>
					<p>
						If you have not performed SSL setup and installation of root
						certificates as part of the abapGit installation you should do it
						now - otherwise you can skip this step.
					</p>
					<p>
						Refer to the relevant SAP Documentation
						<a
							href="https://help.sap.com/saphelp_nw70/helpdata/en/65/6a563cef658a06e10000000a11405a/content.htm"
							target="_blank"
							>Configuring the SAP Web AS for Supporting SSL</a
						>.
					</p>
					<p>
						As you will only be using this code on a development system you may
						choose to use a self-signed certificate.
					</p>
					<p>
						Download the CA root certificate(s) that GitHub uses from
						<a
							href="https://www.digicert.com/digicert-root-certificates.htm"
							target="_blank"
							>https://www.digicert.com/digicert-root-certificates.htm</a
						>. You can find which specific certificate GitHub uses from the
						GitHub documentation or use your web browser to determine it.
					</p>
					<p>
						Install the certificate(s) in STRUST under "SSL System Client SSL
						Client (Anonymous)"
					</p>
					<p>Restart ICM using transaction SMICM</p>
					<p>The certificate list should end up looking something like this:</p>
					<p><img src="images/strust.png" /></p>
					<h2>
						<a
							id="installation1"
							class="anchor"
							href="#installation1"
							aria-hidden="true"
							><span class="octicon octicon-link"></span></a
						>Clone Repository
					</h2>
					<p>
						Use the abapGit `Clone` option to link an ABAP package to my GitHub
						repository. I recommend using a local package just for this purpose
						called something like <code>$SAPUI5DEPLOYER</code>. You are very
						unlikely to want to use a transportable package for this project.
					</p>
					<p><img src="images/clone.png" /></p>
					<p>
						Select the `Pull` option to load all the ABAP artifacts into your
						nominated package.
					</p>
					<h1>
						<a
							id="usage-instructions"
							class="anchor"
							href="#usage-instructions"
							aria-hidden="true"
							><span class="octicon octicon-link"></span></a
						>How To Use
					</h1>
					<p>
						A sample program is included that calls the
						<code>YCL_GITHIB_DEPLOYER</code> class to deploy the
						<a href="https://github.com/grahamrobbo/demojam" target="_blank"
							>grahamrobbo/demojam</a
						>
						repository. Check the
						<a
							href="https://github.com/grahamrobbo/demojam/blob/master/.Ui5RepositoryUploadParameters"
							target="_blank"
							>.Ui5RepositoryUploadParameters</a
						>
						file to see where the app will be deployed to.
					</p>
					<pre><code>REPORT ygithub_deploy_test.

SELECTION-SCREEN BEGIN OF BLOCK blk_main.
PARAMETERS:
  git_repo TYPE string OBLIGATORY LOWER CASE
    DEFAULT `grahamrobbo/demojam`,
  branch   TYPE string OBLIGATORY LOWER CASE
    DEFAULT `master`,
  test     TYPE boolean DEFAULT 'X'.
SELECTION-SCREEN END OF BLOCK blk_main.

START-OF-SELECTION.

  TRY.
      ycl_github_deployer=>deploy(
            repository  = git_repo
            branch      = branch
            test_only   = test ).
    CATCH cx_root INTO DATA(exc).
      MESSAGE exc TYPE 'I' DISPLAY LIKE 'E'.
  ENDTRY.
</code></pre>
					<p>
						The "TEST" flag will build the complete archive but, rather than
						deploying it, will allow you to save it to your local file system.
					</p>
					<h1>
						<a
							id="usage-instructions"
							class="anchor"
							href="#continuous-deployment"
							aria-hidden="true"
							><span class="octicon octicon-link"></span></a
						>Continuous Deployment
					</h1>
					<p>
						If you want to implement a Continuous Deployment solution so that
						the SAPUI5 app is automatically deployed when changes are committed
						I suggest the following two methods.
					</p>
					<p>
						If your infrastructure guys will allow HTTP calls from outside your
						corporate network to be passed through to your development WAS you
						can build a ICF handler that can be called using a
						<a href="https://developer.github.com/webhooks/" target="_blank"
							>GitHub Webhook</a
						>
						whenever there is a commit or branch merge to master. This HTTP call
						could pass through a SAP Web Dispatcher or go to another
						intermediate server that could handle the webhook call. When
						triggered this handler should check the API call for validity before
						calling the <code>YCL_GITHUB_DEPLOYER</code> class. In my opinion
						this is the best way to trigger deployment as the code is only
						executed when actually required. See sample ICF handler
						<code>YCL_GITHUB_WEBHOOK_HANDLER</code> for an example.
					</p>
					<p>
						If you are unable to use the GitHub Webhook method you can build a
						program that calls the
						<a href="https://developer.github.com/" target="_blank"
							>GitHub API</a
						>
						to see if the SHA-1 hash of the master branch has changed. If it has
						then the <code>YCL_GITHUB_DEPLOYER</code> class can be called. I
						suggest storing the SHA-1 hash in a server-side cookie
						(<code>CL_BSP_SERVER_SIDE_COOKIE</code>) for this purpose. This
						program would need to be scheduled as a regular background job so
						that it continually checks if a deployment is required.
					</p>
					<center><img src="images/rocketship.png" width="100%" /></center>
					<h1>
						<a
							id="authors-and-contributors"
							class="anchor"
							href="#authors-and-contributors"
							aria-hidden="true"
							><span class="octicon octicon-link"></span></a
						>Authors and Contributors
					</h1>
					<p>
						SAPUI5-Deployer was built in February 2015 and released for Aussie
						DemoJam 2015 by Graham Robinson (<a
							href="https://github.com/grahamrobbo"
							class="user-mention"
							>@grahamrobbo</a
						>) in May 2015.
					</p>
					<p>
						Version 2 - this version - was released in August 2017 primarily to
						support the use of abapGit to install the repo on your system.
					</p>
					<p>
						Much help came from Michael Moessner - especially with the changes
						to function module <code>/UI5/UI5_REPOSITORY_LOAD_HTTP</code> and
						the code to unwrap the Github archive.
					</p>
					<p>
						Plenty of inspiration and ideas were generated by Matt Harding(<a
							href="https://github.com/mattieharding"
							class="user-mention"
							>@mattieharding</a
						>) and Nigel James(<a
							href="https://github.com/njames"
							class="user-mention"
							>@njames</a
						>).
					</p>
					<p>
						Thanks also to Uwe Fetzer (<a
							href="https://github.com/se38"
							class="user-mention"
							>@se38</a
						>) for his <a href="https://github.com/se38/zJSON">zJSON</a> project
						which was used in Version 1.
					</p>
					<p>Thank you</p>
					<h1>
						<a
							id="support-or-contact"
							class="anchor"
							href="#support-or-contact"
							aria-hidden="true"
							><span class="octicon octicon-link"></span></a
						>Support or Contact
					</h1>
					<p>
						Offered on an "as is" basis. I will try and help you with issues if
						I can but I can't do more than I can do or have time to do.
					</p>
				</section>
				<aside id="sidebar">
					<a href="https://abapgit.org" target="_blank"
						><img src="images/abapgit.png"
					/></a>
					<p></p>
					<a
						href="https://github.com/Yelcho/sapui5-deployer/zipball/master"
						class="button"
						target="_blank"
					>
						<small>Download</small> .zip file
					</a>
					<br />
					<br />
					<br />
					<br />
					<p class="repo-owner">
						<a href="https://github.com/Yelcho/sapui5-deployer"
							>SAPUI5-Deployer</a
						>
						is maintained by
						<a href="https://github.com/Yelcho">Yelcho Systems Consulting</a>.
					</p>
					<a href="https://github.com/Yelcho"><img src="images/boat.gif" /></a>
				</aside>
			</div>
		</div>
		<header>
			<div class="inner">
				<h1>SAPUI5-Deployer</h1>
				<h2>ABAP deployment of SAPUI5 apps from Github</h2>
			</div>
		</header>
	</body>
</html>
